Parser:
  Title: Generic DnsEvents
  Version: '0.1'
  LastUpdated: May 11, 2021
Product:
  Name: Source agnostic
Normalization:
  Schema: Dns
  Version: '0.1.1'
References:
- Title: ASIM DNS Schema
  Link: https://aka.ms/AzSentinelDnsDoc
- Title: ASIM
  Link: https://aka.ms/AzSentinelNormalization
Description: |
  ASIM Source Agnostic DNS Parser
ParserName: ASimDns
Parsers:
  - vimDnsEmpty
  - ASimDnsCiscoUmbrella
  - ASimDnsInfobloxNIOS
  - ASimDnsMicrosoftOMS
  - ASimDnsGcp     
  - ASimDnsCorelightZeek   
  - ASimDnsMicrosoftSysmon
  - ASimDnsAzureFirewall
  - ASimDnsMicrosoftNXlog

ParserQuery: |
  let DisabledParsers=materialize(_GetWatchlist('ASimDisabledParsers') | where SearchKey in ('Any', 'ASimDns') | extend SourceSpecificParser=column_ifexists('SourceSpecificParser','') | distinct SourceSpecificParser);
  let imDnsBuiltInDisabled=toscalar('imDnsBuiltIn' in (DisabledParsers) or 'Any' in (DisabledParsers)); 
  union isfuzzy=true
    vimDnsEmpty
    , ASimDnsCiscoUmbrella     (imDnsBuiltInDisabled or ('ASimDnsCiscoUmbrella'      in (DisabledParsers) ))
    , ASimDnsInfobloxNIOS      (imDnsBuiltInDisabled or ('ASimDnsInfobloxNIOS'       in (DisabledParsers) ))
    , ASimDnsMicrosoftOMS      (imDnsBuiltInDisabled or ('ASimDnsMicrosoftOMS'       in (DisabledParsers) ))
    , ASimDnsGcp               (imDnsBuiltInDisabled or ('ASimDnsDnsGcp'             in (DisabledParsers) ))
    , ASimDnsCorelightZeek     (imDnsBuiltInDisabled or ('ASimDnsCorelightZeek'      in (DisabledParsers) ))
    , ASimDnsMicrosoftSysmon   (imDnsBuiltInDisabled or ('ASimDnsMicrosoftSysmon'    in (DisabledParsers) ))
    , ASimDnsAzureFirewall     (imDnsBuiltInDisabled or ('ASimASimDnsAzureFirewall'  in (DisabledParsers) ))
    , ASimDnsMicrosoftNXlog    (imDnsBuiltInDisabled or ('ASimDnsMicrosoftNXlog'     in (DisabledParsers) ))